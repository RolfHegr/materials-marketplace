<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Materials Marketplace — Style 8: Chip/Tag Filtering</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&display=swap');
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Space Grotesk',sans-serif;background:#f0f0ee;color:#1a1a1a;min-height:100vh}
  .top-nav{display:flex;justify-content:space-between;align-items:center;padding:20px 40px;border-bottom:1px solid #e0e0de}
  .logo{font-weight:600;font-size:16px}
  .page-links{display:flex;gap:4px}
  .page-links a{width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:6px;text-decoration:none;color:#999;font-size:12px;font-weight:500}
  .page-links a:hover,.page-links a.active{background:#1a1a1a;color:#fff}
  .hero{padding:40px 40px 0;max-width:800px}
  .hero h1{font-size:32px;font-weight:300;margin-bottom:8px}
  .hero p{color:#888;font-size:14px;margin-bottom:24px}
  .search-bar{display:flex;gap:12px;margin-bottom:32px;padding:0 40px}
  .search-bar input{flex:1;padding:12px 16px;border:2px solid #1a1a1a;border-radius:24px;font-size:14px;font-family:inherit;background:#fff;max-width:480px}
  .search-bar input:focus{outline:none}
  .filter-sections{padding:0 40px;margin-bottom:32px}
  .filter-row{margin-bottom:16px}
  .filter-row-label{font-size:10px;letter-spacing:2px;text-transform:uppercase;color:#999;margin-bottom:8px;font-weight:400}
  .chips{display:flex;flex-wrap:wrap;gap:6px}
  .chip{padding:6px 14px;border:1.5px solid #d0d0ce;border-radius:20px;font-size:12px;cursor:pointer;background:#fff;transition:all .12s;font-family:inherit;color:#555}
  .chip:hover{border-color:#888;color:#1a1a1a}
  .chip.active{background:#1a1a1a;color:#fff;border-color:#1a1a1a}
  .chip.color-chip{padding:6px 14px 6px 10px;display:flex;align-items:center;gap:6px}
  .chip .dot{width:12px;height:12px;border-radius:50%;border:1px solid rgba(0,0,0,.1)}
  .range-inline{display:flex;align-items:center;gap:12px;background:#fff;border:1.5px solid #d0d0ce;border-radius:20px;padding:4px 16px;width:fit-content}
  .range-inline label{font-size:11px;color:#888;white-space:nowrap}
  .range-inline input[type=range]{width:160px;accent-color:#1a1a1a}
  .range-inline .val{font-size:12px;font-weight:500;min-width:50px}
  .summary-bar{padding:12px 40px;background:#fff;border-top:1px solid #e8e8e6;border-bottom:1px solid #e8e8e6;display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}
  .summary-bar .left{display:flex;align-items:center;gap:12px}
  .summary-bar .count{font-size:13px;font-weight:500}
  .active-chips{display:flex;gap:6px;flex-wrap:wrap}
  .active-chip{font-size:11px;padding:4px 8px;background:#f0f0ee;border-radius:12px;display:flex;align-items:center;gap:4px}
  .active-chip .rm{cursor:pointer;font-weight:600;color:#999}
  .active-chip .rm:hover{color:#1a1a1a}
  .summary-bar .clear{font-size:11px;color:#999;cursor:pointer;text-decoration:underline}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:14px;padding:0 40px 40px}
  .card{background:#fff;border-radius:10px;overflow:hidden;border:1px solid #e8e8e6;transition:transform .15s}
  .card:hover{transform:translateY(-3px);box-shadow:0 6px 20px rgba(0,0,0,.06)}
  .swatch-bar{height:80px;position:relative;display:flex;align-items:flex-end;padding:10px}
  .swatch-bar .fire-badge{background:rgba(255,255,255,.9);font-size:10px;font-weight:600;padding:3px 8px;border-radius:4px}
  .card-body{padding:16px}
  .card-body h3{font-size:14px;font-weight:500;margin-bottom:2px}
  .card-body .brand{font-size:11px;color:#999;margin-bottom:10px}
  .card-body .meta{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:12px}
  .card-body .meta span{font-size:10px;padding:3px 7px;background:#f5f5f3;border-radius:4px;color:#666}
  .card-body .foot{display:flex;justify-content:space-between;align-items:baseline}
  .card-body .price{font-size:18px;font-weight:600}
  .card-body .lead{font-size:10px;color:#bbb}
  .no-results{color:#999;font-style:italic;grid-column:1/-1;padding:40px}
</style>
</head>
<body>
<div class="top-nav">
  <span class="logo">Materials</span>
  <div class="page-links">
    <a href="/1">1</a><a href="/2">2</a><a href="/3">3</a><a href="/4">4</a><a href="/5">5</a>
    <a href="/6">6</a><a href="/7">7</a><a href="/8" class="active">8</a><a href="/9">9</a><a href="/10">10</a>
  </div>
</div>

<div class="hero">
  <h1>Find the right material</h1>
  <p>Filter by type, specification, certification, and more.</p>
</div>

<div class="search-bar">
  <input type="text" id="search" placeholder="Search materials…" oninput="render()">
</div>

<div class="filter-sections">
  <div class="filter-row">
    <div class="filter-row-label">Material Type</div>
    <div class="chips" id="typeChips"></div>
  </div>
  <div class="filter-row">
    <div class="filter-row-label">Fire Class</div>
    <div class="chips" id="fireChips"></div>
  </div>
  <div class="filter-row">
    <div class="filter-row-label">Surface Finish</div>
    <div class="chips" id="finishChips"></div>
  </div>
  <div class="filter-row">
    <div class="filter-row-label">Certification</div>
    <div class="chips" id="certChips"></div>
  </div>
  <div class="filter-row">
    <div class="filter-row-label">Color Family</div>
    <div class="chips" id="colorChips"></div>
  </div>
  <div class="filter-row">
    <div class="filter-row-label">Use</div>
    <div class="chips" id="useChips"></div>
  </div>
  <div class="filter-row" style="display:flex;gap:24px;flex-wrap:wrap">
    <div>
      <div class="filter-row-label">CO₂ Emissions</div>
      <div class="range-inline"><label>Max</label><input type="range" id="co2R" min="0" max="20" step=".5" value="20" oninput="render()"><span class="val" id="co2V">≤ 20</span></div>
    </div>
    <div>
      <div class="filter-row-label">Price</div>
      <div class="range-inline"><label>Max</label><input type="range" id="priceR" min="0" max="350" step="5" value="350" oninput="render()"><span class="val" id="priceV">≤ €350</span></div>
    </div>
    <div>
      <div class="filter-row-label">Lead Time</div>
      <div class="range-inline"><label>Max</label><input type="range" id="leadR" min="1" max="40" value="40" oninput="render()"><span class="val" id="leadV">≤ 40d</span></div>
    </div>
  </div>
</div>

<div class="summary-bar">
  <div class="left">
    <span class="count" id="count">18 materials</span>
    <div class="active-chips" id="activeChips"></div>
  </div>
  <span class="clear" onclick="clearAll()">Clear all</span>
</div>

<div class="grid" id="cards"></div>

<script src="/data.js"></script>
<script>
const colorMap={white:'#e8e4df',grey:'#9a9a96',brown:'#c8a97e',red:'#c4724e',black:'#3d3d3d',green:'#7ba3a0'};
const sel={type:new Set(),fire:new Set(),finish:new Set(),cert:new Set(),color:new Set(),use:new Set()};

function makeChips(id,items,key,colorDots){
  const c=document.getElementById(id);
  items.forEach(v=>{
    const b=document.createElement('button');
    b.className=colorDots?'chip color-chip':'chip';
    if(colorDots) b.innerHTML=`<span class="dot" style="background:${colorMap[v]||'#ccc'}"></span>${v}`;
    else b.textContent=v;
    b.onclick=()=>{b.classList.toggle('active');sel[key].has(v)?sel[key].delete(v):sel[key].add(v);render()};
    c.appendChild(b);
  });
}
makeChips('typeChips',allTypes,'type');
makeChips('fireChips',allFire,'fire');
makeChips('finishChips',allFinish,'finish');
makeChips('certChips',allCert,'cert');
makeChips('colorChips',allColorFamily,'color',true);
makeChips('useChips',allUse,'use');

function render(){
  const q=(document.getElementById('search').value||'').toLowerCase();
  const co2=parseFloat(document.getElementById('co2R').value);
  const price=parseFloat(document.getElementById('priceR').value);
  const lead=parseInt(document.getElementById('leadR').value);
  document.getElementById('co2V').textContent='≤ '+co2;
  document.getElementById('priceV').textContent='≤ €'+price;
  document.getElementById('leadV').textContent='≤ '+lead+'d';

  const f=materials.filter(m=>{
    if(q && !m.name.toLowerCase().includes(q) && !m.type.includes(q) && !m.brand.toLowerCase().includes(q)) return false;
    if(sel.type.size&&!sel.type.has(m.type)) return false;
    if(sel.fire.size&&!sel.fire.has(m.fire)) return false;
    if(sel.finish.size&&!sel.finish.has(m.finish)) return false;
    if(sel.cert.size&&!m.cert.some(c=>sel.cert.has(c))) return false;
    if(sel.color.size&&!sel.color.has(m.colorFamily)) return false;
    if(sel.use.size&&!sel.use.has(m.use)&&!(m.use==='both'&&(sel.use.has('indoor')||sel.use.has('outdoor')))) return false;
    if(m.co2>co2) return false;
    if(m.price>price) return false;
    if(m.leadDays>lead) return false;
    return true;
  });

  document.getElementById('count').textContent=f.length+' materials';

  let ac='';
  for(const[k,s]of Object.entries(sel)) s.forEach(v=>ac+=`<span class="active-chip">${v}<span class="rm" onclick="sel['${k}'].delete('${v}');document.querySelectorAll('#${k}Chips .chip').forEach(c=>{if(c.textContent.trim()==='${v}'||c.textContent.trim().endsWith('${v}'))c.classList.remove('active')});render()">×</span></span>`);
  document.getElementById('activeChips').innerHTML=ac;

  renderCards('cards',f,m=>`<div class="card">
    <div class="swatch-bar" style="background:${m.color}"><span class="fire-badge">${m.fire}</span></div>
    <div class="card-body">
      <h3>${m.name}</h3>
      <div class="brand">${m.brand}</div>
      <div class="meta"><span>${m.type}</span><span>${m.finish}</span><span>${m.use}</span><span>CO₂ ${m.co2}</span>${m.cert.map(c=>`<span>${c}</span>`).join('')}</div>
      <div class="foot"><span class="price">€${m.price}</span><span class="lead">${m.leadDays}d</span></div>
    </div>
  </div>`);
}

function clearAll(){for(const s of Object.values(sel))s.clear();document.querySelectorAll('.chip').forEach(c=>c.classList.remove('active'));document.getElementById('co2R').value=20;document.getElementById('priceR').value=350;document.getElementById('leadR').value=40;document.getElementById('search').value='';render()}

render();
</script>
</body>
</html>
