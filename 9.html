<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Materials Marketplace — Style 9: Mobile Drawer</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@300;400;500&family=IBM+Plex+Sans:wght@300;400;500;600&display=swap');
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'IBM Plex Sans',sans-serif;background:#111;color:#e0e0e0;min-height:100vh;max-width:420px;margin:0 auto;position:relative;overflow-x:hidden}
  .status-bar{padding:8px 20px;font-family:'IBM Plex Mono',monospace;font-size:10px;color:#555;display:flex;justify-content:space-between}
  header{padding:16px 20px 12px;display:flex;justify-content:space-between;align-items:center}
  header h1{font-size:18px;font-weight:500;letter-spacing:1px}
  .nav-pills{display:flex;gap:4px;padding:0 20px 12px;overflow-x:auto}
  .nav-pills a{font-family:'IBM Plex Mono',monospace;font-size:10px;padding:4px 10px;border:1px solid #333;color:#666;text-decoration:none;border-radius:4px;white-space:nowrap}
  .nav-pills a.active{border-color:#e0e0e0;color:#e0e0e0}
  .filter-trigger{margin:0 20px 16px;padding:12px 16px;background:#1a1a1a;border:1px solid #333;border-radius:8px;display:flex;justify-content:space-between;align-items:center;cursor:pointer}
  .filter-trigger span{font-family:'IBM Plex Mono',monospace;font-size:12px;color:#888}
  .filter-trigger .badge{background:#fff;color:#111;font-size:10px;font-weight:600;padding:2px 8px;border-radius:10px}
  .quick-chips{padding:0 20px 16px;display:flex;gap:6px;overflow-x:auto}
  .quick-chips::-webkit-scrollbar{display:none}
  .qchip{padding:6px 14px;border:1px solid #333;border-radius:16px;font-size:11px;color:#888;cursor:pointer;white-space:nowrap;background:transparent;font-family:inherit}
  .qchip.active{background:#fff;color:#111;border-color:#fff}
  .results-label{padding:0 20px;font-family:'IBM Plex Mono',monospace;font-size:10px;color:#555;margin-bottom:12px}
  .list{padding:0 20px 100px}
  .list-item{background:#1a1a1a;border:1px solid #222;border-radius:8px;padding:14px;margin-bottom:8px;display:flex;gap:14px}
  .list-item .swatch{width:48px;height:48px;border-radius:6px;flex-shrink:0}
  .list-item .info{flex:1;min-width:0}
  .list-item h3{font-size:14px;font-weight:500;margin-bottom:2px;color:#e0e0e0}
  .list-item .sub{font-family:'IBM Plex Mono',monospace;font-size:10px;color:#666;margin-bottom:6px}
  .list-item .tags{display:flex;gap:4px;flex-wrap:wrap;margin-bottom:6px}
  .list-item .tag{font-family:'IBM Plex Mono',monospace;font-size:9px;padding:2px 6px;border:1px solid #333;border-radius:3px;color:#888}
  .list-item .price-row{display:flex;justify-content:space-between;align-items:baseline}
  .list-item .price{font-size:16px;font-weight:600;color:#fff}
  .list-item .lead{font-family:'IBM Plex Mono',monospace;font-size:10px;color:#555}
  .no-results{color:#555;font-style:italic;padding:40px 20px}

  /* Drawer */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:90;opacity:0;pointer-events:none;transition:opacity .25s}
  .overlay.show{opacity:1;pointer-events:auto}
  .drawer{position:fixed;bottom:0;left:50%;transform:translateX(-50%);width:420px;max-width:100%;background:#1a1a1a;border-radius:16px 16px 0 0;z-index:100;max-height:85vh;overflow-y:auto;transform:translateX(-50%) translateY(100%);transition:transform .3s ease}
  .drawer.show{transform:translateX(-50%) translateY(0)}
  .drawer-handle{width:40px;height:4px;background:#444;border-radius:2px;margin:12px auto 8px}
  .drawer-header{display:flex;justify-content:space-between;align-items:center;padding:8px 20px 16px}
  .drawer-header h2{font-size:16px;font-weight:500}
  .drawer-header button{background:none;border:none;color:#888;font-size:24px;cursor:pointer}
  .drawer-section{padding:0 20px 20px}
  .drawer-section h3{font-family:'IBM Plex Mono',monospace;font-size:10px;text-transform:uppercase;letter-spacing:1.5px;color:#555;margin-bottom:10px;font-weight:400}
  .drawer .chips{display:flex;flex-wrap:wrap;gap:6px}
  .drawer .chip{padding:6px 12px;border:1px solid #333;border-radius:16px;font-size:11px;color:#888;cursor:pointer;background:transparent;font-family:inherit}
  .drawer .chip.active{background:#fff;color:#111;border-color:#fff}
  .drawer .checkbox-col{display:flex;flex-direction:column;gap:8px}
  .drawer .checkbox-col label{font-size:12px;display:flex;align-items:center;gap:8px;color:#888;cursor:pointer}
  .drawer .checkbox-col input{accent-color:#fff}
  .drawer .range-block{margin-bottom:4px}
  .drawer .range-block input[type=range]{width:100%;accent-color:#fff}
  .drawer .range-block .rng-labels{display:flex;justify-content:space-between;font-family:'IBM Plex Mono',monospace;font-size:10px;color:#555}
  .drawer-footer{padding:16px 20px;border-top:1px solid #333;display:flex;gap:12px}
  .drawer-footer button{flex:1;padding:12px;border:none;border-radius:8px;font-family:inherit;font-size:13px;font-weight:500;cursor:pointer}
  .btn-reset{background:#222;color:#888}
  .btn-apply{background:#fff;color:#111}
</style>
</head>
<body>
<div class="status-bar"><span>materials.arch</span><span>v0.9</span></div>
<header>
  <h1>Materials</h1>
</header>
<div class="nav-pills">
  <a href="/1">01</a><a href="/2">02</a><a href="/3">03</a><a href="/4">04</a><a href="/5">05</a>
  <a href="/6">06</a><a href="/7">07</a><a href="/8">08</a><a href="/9" class="active">09</a><a href="/10">10</a>
</div>

<div class="filter-trigger" onclick="openDrawer()">
  <span>Filters</span>
  <span class="badge" id="filterCount">0</span>
</div>

<div class="quick-chips" id="quickChips"></div>
<div class="results-label" id="count"></div>
<div class="list" id="cards"></div>

<div class="overlay" id="overlay" onclick="closeDrawer()"></div>
<div class="drawer" id="drawer">
  <div class="drawer-handle"></div>
  <div class="drawer-header"><h2>Filter Materials</h2><button onclick="closeDrawer()">×</button></div>

  <div class="drawer-section">
    <h3>Material Type</h3>
    <div class="chips" id="dType"></div>
  </div>
  <div class="drawer-section">
    <h3>Fire Safety Class</h3>
    <div class="chips" id="dFire"></div>
  </div>
  <div class="drawer-section">
    <h3>Surface Finish</h3>
    <div class="chips" id="dFinish"></div>
  </div>
  <div class="drawer-section">
    <h3>Certifications</h3>
    <div class="checkbox-col" id="dCert"></div>
  </div>
  <div class="drawer-section">
    <h3>Indoor / Outdoor</h3>
    <div class="chips" id="dUse"></div>
  </div>
  <div class="drawer-section">
    <h3>CO₂ Emissions (max)</h3>
    <div class="range-block"><input type="range" id="dCo2" min="0" max="20" step=".5" value="20" oninput="document.getElementById('dCo2V').textContent='≤ '+this.value+' kg/m²'"><div class="rng-labels"><span>0</span><span id="dCo2V">≤ 20 kg/m²</span></div></div>
  </div>
  <div class="drawer-section">
    <h3>Price (max)</h3>
    <div class="range-block"><input type="range" id="dPrice" min="0" max="350" step="5" value="350" oninput="document.getElementById('dPriceV').textContent='≤ €'+this.value"><div class="rng-labels"><span>€0</span><span id="dPriceV">≤ €350</span></div></div>
  </div>
  <div class="drawer-section">
    <h3>Lead Time (max)</h3>
    <div class="range-block"><input type="range" id="dLead" min="1" max="40" value="40" oninput="document.getElementById('dLeadV').textContent='≤ '+this.value+' days'"><div class="rng-labels"><span>1 day</span><span id="dLeadV">≤ 40 days</span></div></div>
  </div>

  <div class="drawer-footer">
    <button class="btn-reset" onclick="resetDrawer()">Reset</button>
    <button class="btn-apply" onclick="applyDrawer()">Show Results</button>
  </div>
</div>

<script src="/data.js"></script>
<script>
const sel={type:new Set(),fire:new Set(),finish:new Set(),cert:new Set(),use:new Set()};

function makeDrawerChips(id,items,key){
  const c=document.getElementById(id);
  items.forEach(v=>{const b=document.createElement('button');b.className='chip';b.textContent=v;b.onclick=()=>{b.classList.toggle('active');sel[key].has(v)?sel[key].delete(v):sel[key].add(v)};c.appendChild(b)});
}
function makeDrawerChecks(id,items,key){
  const c=document.getElementById(id);
  items.forEach(v=>{const l=document.createElement('label');l.innerHTML=`<input type="checkbox" onchange="sel['${key}'].has('${v}')?sel['${key}'].delete('${v}'):sel['${key}'].add('${v}')"> ${v}`;c.appendChild(l)});
}
makeDrawerChips('dType',allTypes,'type');
makeDrawerChips('dFire',allFire,'fire');
makeDrawerChips('dFinish',allFinish,'finish');
makeDrawerChecks('dCert',allCert,'cert');
makeDrawerChips('dUse',allUse,'use');

// Quick chips = type shortcuts
const qc=document.getElementById('quickChips');
['all',...allTypes].forEach(t=>{const b=document.createElement('button');b.className='qchip'+(t==='all'?' active':'');b.textContent=t;b.onclick=()=>{document.querySelectorAll('.qchip').forEach(x=>x.classList.remove('active'));b.classList.add('active');sel.type.clear();if(t!=='all')sel.type.add(t);render()};qc.appendChild(b)});

function openDrawer(){document.getElementById('overlay').classList.add('show');document.getElementById('drawer').classList.add('show')}
function closeDrawer(){document.getElementById('overlay').classList.remove('show');document.getElementById('drawer').classList.remove('show')}
function applyDrawer(){closeDrawer();render()}
function resetDrawer(){for(const s of Object.values(sel))s.clear();document.querySelectorAll('.drawer .chip').forEach(c=>c.classList.remove('active'));document.querySelectorAll('.drawer input[type=checkbox]').forEach(i=>i.checked=false);document.getElementById('dCo2').value=20;document.getElementById('dPrice').value=350;document.getElementById('dLead').value=40;document.getElementById('dCo2V').textContent='≤ 20 kg/m²';document.getElementById('dPriceV').textContent='≤ €350';document.getElementById('dLeadV').textContent='≤ 40 days';render()}

function render(){
  const co2=parseFloat(document.getElementById('dCo2').value);
  const price=parseFloat(document.getElementById('dPrice').value);
  const lead=parseInt(document.getElementById('dLead').value);
  let activeCount=0;
  for(const s of Object.values(sel))activeCount+=s.size;
  if(co2<20)activeCount++;if(price<350)activeCount++;if(lead<40)activeCount++;
  document.getElementById('filterCount').textContent=activeCount;

  const f=materials.filter(m=>{
    if(sel.type.size&&!sel.type.has(m.type))return false;
    if(sel.fire.size&&!sel.fire.has(m.fire))return false;
    if(sel.finish.size&&!sel.finish.has(m.finish))return false;
    if(sel.cert.size&&!m.cert.some(c=>sel.cert.has(c)))return false;
    if(sel.use.size&&!sel.use.has(m.use)&&!(m.use==='both'&&(sel.use.has('indoor')||sel.use.has('outdoor'))))return false;
    if(m.co2>co2)return false;
    if(m.price>price)return false;
    if(m.leadDays>lead)return false;
    return true;
  });
  document.getElementById('count').textContent='// '+f.length+' results';
  renderCards('cards',f,m=>`<div class="list-item">
    <div class="swatch" style="background:${m.color}"></div>
    <div class="info">
      <h3>${m.name}</h3>
      <div class="sub">${m.brand} · ${m.type} · ${m.finish}</div>
      <div class="tags"><span class="tag">${m.fire}</span><span class="tag">CO₂ ${m.co2}</span><span class="tag">${m.use}</span>${m.cert.map(c=>`<span class="tag">${c}</span>`).join('')}</div>
      <div class="price-row"><span class="price">€${m.price}</span><span class="lead">${m.leadDays}d lead</span></div>
    </div>
  </div>`);
}
render();
</script>
</body>
</html>
